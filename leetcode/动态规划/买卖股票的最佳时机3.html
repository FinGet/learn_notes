<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <link rel="stylesheet" href="">
</head>

<body>
	<pre>
		给定一个数组，它的第 i 个元素是一支给定的股票在第 i 天的价格。

		设计一个算法来计算你所能获取的最大利润。你最多可以完成 两笔 交易。
		输入：prices = [3,3,5,0,0,3,1,4]
		输出：6
		解释：在第 4 天（股票价格 = 0）的时候买入，在第 6 天（股票价格 = 3）的时候卖出，这笔交易所能获得利润 = 3-0 = 3 。
		     随后，在第 7 天（股票价格 = 1）的时候买入，在第 8 天 （股票价格 = 4）的时候卖出，这笔交易所能获得利润 = 4-1 = 3 。
	</pre>
  <script type="text/javascript">
  /**
   * 如果说最大允许一次交易，那么大多数人都知道怎么解决。下面让我们把这道题转化成『最大允许一次交易』
    『当前卖出的最大利润』=『这次卖出的价格』-『买入的最低价格』
    继续变形：
    『当前卖出的最大利润』=『这次卖出的价格』-『买入的综合最低价格』
    什么是『买入的综合最低价格』呢？就是（『买入价格』-『上一次的买卖利润最大值）的最小值
   */
  
  var maxProfit = function(prices) {
    let min1 = prices[0];  
    let min2 = prices[0];  
    let max1 = 0; 
    let max2 = 0;  
    for (let index = 1; index < prices.length; index++) {    
      // 当前遇到的最低价    
      min1 = Math.min(min1, prices[index]);    
      // 当前为止，第一次交易赚的钱的最大值    
      max1 = Math.max(max1, prices[index] - min1);    
      // 当前买入的综合最低价(计算了上一个交易的利润)    
      min2 = Math.min(min2, prices[index] - max1);    
      // 当前卖出的最高利润    
      max2 = Math.max(max2, prices[index] - min2);  
      console.log(min1, max1, min2, max2)
    }  
    return max2;
  };
  maxProfit([3,3,5,0,0,3,1,4])
  </script>
</body>

</html>