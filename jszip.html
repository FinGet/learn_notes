<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <link rel="stylesheet" href="">
  <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.js"></script>
  <script type="text/javascript" src="./jszip.min.js"></script>
</head>

<body>
  <h3>Choose the local(s) zip file(s)</h3>
  <p class="note">Note : your browser will process the zip file, don't choose a file too big !</p>
  <input type="file" id="file" name="file" multiple /><br />
  <div id="result_block" class="hidden">
    <h3>Content :</h3>
    <div id="result"></div>
  </div>
  <script type="text/javascript">
  var $result = $("#result");
  $("#file").on("change", function(evt) {
    // remove content
    $result.html("");
    // be sure to show the results
    $("#result_block").removeClass("hidden").addClass("show");

    // Closure to capture the file information.
    function handleFile(f) {
      var $title = $("<h4>", {
        text: f.name
      });
      var $fileContent = $("<ul>");
      $result.append($title);
      $result.append($fileContent);

      var dateBefore = new Date();
      JSZip.loadAsync(f) // 1) read the Blob
        .then(function(zip) {
        	console.log(zip)
          var dateAfter = new Date();
          $title.append($("<span>", {
            "class": "small",
            text: " (loaded in " + (dateAfter - dateBefore) + "ms)"
          }));

          // zip.file('base/manifest/AndroidManifest.xml').async("string").then(text => {
          // 	console.log(text)
          // })
          // zip.file('base/assets/channel_msg.txt').async("string").then(text => {
          //   console.log(text)
          // })
          
          // zip.file('assets/herosdkcfg.xml').async("string").then(text => {
          //   console.log(text)
          // })
          // zip.file('base/resources.pb').async("string").then(text => {
          //   console.log(text)
          // })
          // zip.file('base_assets/assets/herosdkcfg.xml').async("string").then(text => {
          //   console.log(text)
          // })
          // base/assets/android/android.manifest
          // zip.file('base/assets/android/android.manifest').async("string").then(text => {
          //  console.log(text)
          // })
          // zip.file('AndroidManifest.xml').async("string").then(text => {
          //   console.log(text)
          // })
          // Payload/Ohana-mobile.app/Frameworks/Game.framework/GAME_Common.bundle/data/GameSDKSettings.plist
          // zip.file('assets/herosdkcfg.xml').async("string").then(text => {
          // 	console.log(text)
          // }) 
          zip.forEach(function(relativePath, zipEntry) { // 2) print entries
            $fileContent.append($("<li>", {
              text: zipEntry.name
            }));
          });
        }, function(e) {
          $result.append($("<div>", {
            "class": "alert alert-danger",
            text: "Error reading " + f.name + ": " + e.message
          }));
        });
    }

    var files = evt.target.files;
    for (var i = 0; i < files.length; i++) {
      handleFile(files[i]);
    }
  });
  </script>
</body>

</html>


